<!DOCTYPE html>
<html>
<head>
    <title>Sequence Scan и Index Scan в PostgreSQL</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        pre {
            background: #f4f4f4;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Sequence Scan и Index Scan в PostgreSQL</h1>

        <h2>Обычное сканирование (Sequence Scan)</h2>
        <p>Sequence Scan (последовательное сканирование) — это метод доступа к данным, при котором PostgreSQL читает каждую строку таблицы по порядку, начиная с первой и до последней. Sequence Scan используется, когда:</p>
        <ul>
            <li>В запросе отсутствуют индексы.</li>
            <li>PostgreSQL считает, что использование индекса не будет эффективным.</li>
            <li>Запросу необходимо обработать все или большинство строк в таблице.</li>
        </ul>

        <h3>Пример использования Sequence Scan</h3>

        <h4>Создание таблицы и вставка данных</h4>
        <pre><code>CREATE TABLE products (
    id SERIAL PRIMARY KEY,
    name TEXT,
    price NUMERIC
);

INSERT INTO products (name, price) VALUES
('Product 1', 10.00),
('Product 2', 15.00),
('Product 3', 20.00);</code></pre>

        <h4>Запрос, использующий Sequence Scan</h4>
        <pre><code>SELECT * FROM products;</code></pre>
        <p>Этот запрос выполнит последовательное сканирование, так как он выбирает все строки таблицы.</p>

        <h3>Преимущества и недостатки Sequence Scan</h3>

        <h4>Преимущества</h4>
        <ul>
            <li><strong>Простота</strong>: Не требует дополнительных структур данных.</li>
            <li><strong>Универсальность</strong>: Может использоваться для любых типов запросов.</li>
            <li><strong>Оптимально для малых таблиц</strong>: Эффективен для небольших таблиц или когда требуется прочитать все строки таблицы.</li>
        </ul>

        <h4>Недостатки</h4>
        <ul>
            <li><strong>Медлительность для больших таблиц</strong>: Полное сканирование всех строк таблицы может занять много времени для больших таблиц.</li>
            <li><strong>Низкая производительность для выборочных запросов</strong>: Неэффективен для выборки небольшого количества строк из большой таблицы.</li>
        </ul>

        <h2>Индексное сканирование (Index Scan)</h2>
        <p>Index Scan (сканирование индекса) — это метод доступа к данным в PostgreSQL, при котором сервер базы данных использует индекс для быстрого поиска нужных строк в таблице. В отличие от последовательного сканирования (Sequence Scan), Index Scan позволяет быстро находить данные по значению индекса, что значительно ускоряет выполнение запросов.</p>

        <h3>Пример использования Index Scan</h3>

        <h4>Создание таблицы и индекса</h4>
        <pre><code>CREATE TABLE employees (
    id SERIAL PRIMARY KEY,
    last_name TEXT,
    first_name TEXT,
    department TEXT
);

CREATE INDEX idx_last_name ON employees (last_name);</code></pre>

        <h4>Запрос с использованием Index Scan</h4>
        <pre><code>EXPLAIN ANALYZE SELECT * FROM employees WHERE last_name = 'Ivanov';</code></pre>
        <p>Вывод команды <code>EXPLAIN ANALYZE</code> покажет, что запрос использует Index Scan.</p>

        <h3>Типы Index Scan</h3>
        <ul>
            <li><strong>Index Scan</strong>: Стандартное сканирование индекса для поиска строк по значению индекса.</li>
            <li><strong>Bitmap Index Scan</strong>: Комбинирует результаты нескольких сканирований индексов, создавая битовую карту, которая затем используется для выборки строк.</li>
            <li><strong>Index Only Scan</strong>: Читает только данные из индекса, без доступа к самой таблице, что улучшает производительность для часто используемых запросов.</li>
        </ul>

        <h3>Преимущества и недостатки Index Scan</h3>

        <h4>Преимущества</h4>
        <ul>
            <li><strong>Быстрота</strong>: Существенно ускоряет выполнение запросов по сравнению с последовательным сканированием.</li>
            <li><strong>Эффективность для выборочных запросов</strong>: Оптимален для запросов, которые выбирают небольшое количество строк.</li>
            <li><strong>Разнообразие</strong>: Поддержка различных типов индексов позволяет оптимизировать выполнение запросов под разные сценарии.</li>
        </ul>

        <h4>Недостатки</h4>
        <ul>
            <li><strong>Накладные расходы на обновление</strong>: При вставке, обновлении или удалении данных индексы также должны быть обновлены, что может снизить производительность этих операций.</li>
            <li><strong>Дополнительное место на диске</strong>: Индексы требуют дополнительного места для хранения.</li>
        </ul>
    </div>
</body>
</html>
